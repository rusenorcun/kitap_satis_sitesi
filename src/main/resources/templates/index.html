<!doctype html>
<html lang="tr"
	  xmlns:th="http://www.thymeleaf.org"
	  xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<title>KitapYurdu â€¢ Ana Sayfa</title>
	<link rel="stylesheet" th:href="@{/css/app.css}" href="/css/app.css" />
</head>

<body class="theme-light">
<header class="topbar">
	<div class="container topbar__inner">
		<a class="brand" th:href="@{/}" href="/">
			<span class="brand__mark">KY</span>
			<span class="brand__text">KitapYurdu</span>
		</a>

		<nav class="nav">
			<a class="nav__link is-active" th:href="@{/}" href="/">Ana Sayfa</a>
			<a class="nav__link" th:href="@{/katalog}" href="/katalog">Katalog</a>
			<a class="nav__link" th:href="@{/sepet}" href="/sepet">
				Sepet
				<span class="pill" th:text="${cartCount != null ? cartCount : 0}">0</span>
			</a>

			<!--  Profil sadece giriÅŸ yapÄ±nca -->
			<a class="nav__link" th:href="@{/profil}" href="/profil" sec:authorize="isAuthenticated()">Profil</a>
		</nav>

		<div class="topbar__actions">

			<!--  Admin linki: sadece admin role -->
			<a class="btn btn--ghost" th:href="@{/admin}" href="/admin" sec:authorize="hasRole('ADMIN')">
				Admin
			</a>

			<!--  GiriÅŸ yoksa: GiriÅŸ butonu -->
			<a class="btn btn--ghost" th:href="@{/login}" href="/login" sec:authorize="isAnonymous()">
				GiriÅŸ
			</a>

			<!--  GiriÅŸ varsa: Ã‡Ä±kÄ±ÅŸ butonu (POST /logout + CSRF) -->
			<form th:action="@{/logout}" method="post" sec:authorize="isAuthenticated()" style="display:inline; margin:0;">
				<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
				<button type="submit" class="btn btn--ghost">Ã‡Ä±kÄ±ÅŸ</button>
			</form>

			<button class="themeToggle" type="button" data-theme-toggle aria-pressed="false">
				<span class="themeIcon">â˜€ï¸</span><span class="themeText">AÃ§Ä±k</span>
			</button>

		</div>
	</div>
</header>

<main class="container">
	<!-- HERO -->
	<section class="hero hero--light">
		<div class="hero__content">
			<h1 class="hero__title">KitabÄ±nÄ± seÃ§, sepete ekle, gÃ¼venle satÄ±n al.</h1>
			<p class="hero__subtitle">
				Yeni Ã§Ä±kanlar, az kalanlar ve Ã¶ne Ã§Ä±kanlar tek bir yerde. HÄ±zlÄ± arama ile kataloÄŸa geÃ§.
			</p>

			<div class="hero__cta">
				<a class="btn btn--secondary" th:href="@{/katalog}" href="/katalog">KataloÄŸa Git</a>
				<a class="btn btn--secondary" th:href="@{/sepet}" href="/sepet">Sepeti GÃ¶r</a>
			</div>

			<div class="hero__stats">
				<div class="stat">
					<div class="stat__value" th:text="${toplamKitapSayisi != null ? toplamKitapSayisi : '-'}">-</div>
					<div class="stat__label">Toplam Kitap</div>
				</div>
				<div class="stat">
					<div class="stat__value" th:text="${aktifKitapSayisi != null ? aktifKitapSayisi : '-'}">-</div>
					<div class="stat__label">Listede</div>
				</div>
				<div class="stat">
					<div class="stat__value" th:text="${yayineviSayisi != null ? yayineviSayisi : '-'}">-</div>
					<div class="stat__label">YayÄ±nevi</div>
				</div>
			</div>

			<div class="trust">
				<div class="trust__item"><span class="trust__icon">ğŸšš</span> HÄ±zlÄ± kargo</div>
				<div class="trust__item"><span class="trust__icon">â†©ï¸</span> Kolay iade</div>
				<div class="trust__item"><span class="trust__icon">ğŸ”’</span> GÃ¼venli Ã¶deme</div>
				<div class="trust__item"><span class="trust__icon">ğŸ’¬</span> Yorum & puan</div>
			</div>
		</div>

		<div class="hero__panel">
			<div class="card card--soft">
				<div class="card__header">
					<h2 class="card__title">HÄ±zlÄ± Arama</h2>
					<p class="card__desc">Kitap adÄ±nÄ± yaz, kataloÄŸa geÃ§.</p>
				</div>

				<form class="search" th:action="@{/katalog}" method="get">
					<label class="field">
						<span class="field__label">Arama</span>
						<input class="input" name="q" type="text" placeholder="Ã–rn: SimyacÄ±, Sefiller..." />
					</label>

					<button class="btn btn--secondary btn--block" type="submit">Ara</button>

					<p class="hint">Katalog sayfasÄ±nda filtreleme ve sayfalama ekleyeceÄŸiz.</p>
				</form>
			</div>

			<div class="card">
				<div class="card__header">
					<h2 class="card__title">BugÃ¼n Ne Okusam?</h2>
					<p class="card__desc">Ã–ne Ã§Ä±kanlardan hÄ±zlÄ± seÃ§im.</p>
				</div>

				<div class="card__body">
					<div class="miniList">
						<a class="miniItem" th:each="b,st : ${featured}" th:if="${st.index < 4}"
						   th:href="@{/kitap/{id}(id=${b.kitapId})}" href="/kitap/1">
							<span class="miniItem__title" th:text="${b.kitapAdi}">Kitap</span>
							<span class="miniItem__meta">
								<span th:text="${b.yayineviAdi != null ? b.yayineviAdi : '-'}">-</span>
								â€¢ <span th:text="${b.fiyat != null ? b.fiyat : '-'}">-</span> â‚º
							</span>
						</a>

						<div class="empty muted" th:if="${featured == null || #lists.isEmpty(featured)}">
							HenÃ¼z listelenecek kitap yok.
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>

	<!-- LIMITED STOCK -->
	<section class="section">
		<div class="section__head">
			<h2 class="section__title">Stokta SÄ±nÄ±rlÄ± Kalanlar</h2>
			<p class="section__subtitle">TÃ¼kenecek Ã¼rÃ¼nleri kaÃ§Ä±rma (stok â‰¤ 5).</p>
		</div>

		<div class="productGrid">
			<article class="productCard" th:each="b : ${limited}">
				<a class="productCard__img" th:href="@{/kitap/{id}(id=${b.kitapId})}" href="/kitap/1" aria-label="Kitap detayÄ±">
					<div class="imgPh">ğŸ“˜</div>
					<span class="badge badge--warn">Az kaldÄ±</span>
				</a>

				<div class="productCard__body">
					<div class="productCard__title" th:text="${b.kitapAdi}">Kitap AdÄ±</div>
					<div class="productCard__meta">
						<span th:text="${b.yayineviAdi != null ? b.yayineviAdi : '-'}">YayÄ±nevi</span>
						<span class="dot">â€¢</span>
						<span>Stok: <b th:text="${b.stok}">3</b></span>
					</div>

					<div class="productCard__foot">
						<div class="price">
							<span class="price__value" th:text="${b.fiyat != null ? b.fiyat : '-'}">0</span>
							<span class="price__cur">â‚º</span>
						</div>
						<a class="btn btn--secondary btn--sm" th:href="@{/sepet/add(kitapId=${b.kitapId})}" href="/sepet/add?kitapId=1">
							Sepete Ekle
						</a>
					</div>
				</div>
			</article>

			<div class="empty muted" th:if="${limited == null || #lists.isEmpty(limited)}">
				Åu an â€œaz kalanâ€ Ã¼rÃ¼n yok.
			</div>
		</div>
	</section>

	<!-- FEATURED -->
	<section class="section">
		<div class="section__head">
			<h2 class="section__title">Ã–ne Ã‡Ä±kanlar</h2>
			<p class="section__subtitle">Yeni eklenenlerden seÃ§tiklerimiz.</p>
		</div>

		<div class="productGrid">
			<article class="productCard" th:each="b : ${featured}">
				<a class="productCard__img" th:href="@{/kitap/{id}(id=${b.kitapId})}" href="/kitap/1">
					<div class="imgPh">ğŸ“—</div>
					<span class="badge badge--info">Yeni</span>
				</a>

				<div class="productCard__body">
					<div class="productCard__title" th:text="${b.kitapAdi}">Kitap AdÄ±</div>
					<div class="productCard__meta">
						<span th:text="${b.yayineviAdi != null ? b.yayineviAdi : '-'}">YayÄ±nevi</span>
						<span class="dot">â€¢</span>
						<span th:text="${b.kategoriler != null ? b.kategoriler : 'Kategori'}">Kategori</span>
					</div>

					<div class="productCard__foot">
						<div class="price">
							<span class="price__value" th:text="${b.fiyat != null ? b.fiyat : '-'}">0</span>
							<span class="price__cur">â‚º</span>
						</div>

						<a class="btn btn--secondary btn--sm" th:href="@{/kitap/{id}(id=${b.kitapId})}" href="/kitap/1">
							Detay
						</a>
					</div>
				</div>
			</article>

			<div class="empty muted" th:if="${featured == null || #lists.isEmpty(featured)}">
				HenÃ¼z Ã¶ne Ã§Ä±kan Ã¼rÃ¼n yok.
			</div>
		</div>
	</section>

	<!-- CTA -->
	<section class="banner">
		<div class="banner__inner">
			<div>
				<h3 class="banner__title">TÃ¼m kitaplarÄ± keÅŸfet</h3>
				<p class="banner__text">Filtrele, ara, karÅŸÄ±laÅŸtÄ±r. SatÄ±n alma akÄ±ÅŸÄ±nÄ± sÄ±rayla kuracaÄŸÄ±z.</p>
			</div>
			<a class="btn btn--secondary" th:href="@{/katalog}" href="/katalog">KataloÄŸa Git</a>
		</div>
	</section>
</main>

<footer class="footer footer--light">
	<div class="container footer__inner">
		<div class="muted">Â© <span th:text="${#dates.format(#dates.createNow(),'yyyy')}">2025</span> RuÅŸen OrÃ§un KoÃ§er</div>
		<div class="muted">Anasayfa</div>
	</div>
</footer>

<script th:src="@{/js/theme.js}" src="/js/theme.js"></script>
<script th:src="@{/js/app.js}" src="/js/app.js"></script>
<script th:src="@{/js/toast.js}" src="/js/toast.js"></script>
</body>
</html>
